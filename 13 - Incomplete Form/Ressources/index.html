<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <title>Darkly - achoquel</title>
  <script src="js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="../../WebViewer/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../WebViewer/css/custom.css">
</head>

<body>
  <div id="wrapper">
    <nav class="navbar navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="../../WebViewer/index.html">Darkly</a>
      </div>
    </nav>
    <main class="container">
      <div class="row">
        <div class="col-md-12 mt-5">
          <img src="../../WebViewer/img/form.png" class="img-thumbnail rounded mx-auto d-block img-top"
            alt="Incomplete form & mail bomb attack">
          <h1>Incomplete form & mail bomb attack
          </h1>
          <p class="lead">The form to ask for a password reset is very strange and is missing informations. We can also use it to mail bomb peoples because of the way it is designed.</p>
          <hr>
          <p class="lead">
            On a normal password reset form, you are supposed to enter your email / username, in order to receive a link by email to be able to change your password. On this website, there is no input to enter your email, but instead there is a hidden input with the email of an administrator of the website.<br>
            Basically, I don't know how your password could be resetted this way, because you are just sending an email to an admin, without any informations about who you are.<br><br>
            The biggest problem here is that you can edit the email in the hidden field, and potentially do a mail bomb attack with a simple script, that will send thousands of requests on the endpoint with the email of the victim.
            <code>curl -X POST -F "mail=&ltemail of the victim>" -F "Submit=submit" http://192.168.56.101/index.php?page=recover</code>
            <br><br>
            The flag is 1D4855F7337C0C14B6F44946872C4EB33853F40B2D54393FBE94F49F1E19BBB0
          </p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mt-5">
          <h2>Risks</h2>
          <hr>
          <p class="lead">The first risk if we can call it one is to loose users on your website, because they can't login when not remembering their passowrd and when they can't reset it.<br><br>The other risk as stated above is the mail bombing attack with this form.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mt-5">
          <h2>How to fix ?</h2>
          <hr>
          <p class="lead">
            You can fix this by creating a "normal" password reset form, with a field to enter your email, and en endpoint that will verify that the email exists and that sends an email to the user, instead of the administrator.
          </p>
        </div>
      </div>
    </main>
  </div>
</body>

</html>